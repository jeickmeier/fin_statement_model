# Refactor `fin_statement_model.io` – TODO checklist

## Overview
Track progress while migrating the IO package to the new, cleaner layout.

---

### 0. Bootstrap
- [x] Create new directory skeleton under `fin_statement_model/io` (`formats`, `adjustments`, `graph`, `statements`, etc.)

### 1. Core helpers
- [x] Implement `core/dataframe_reader_base.py` (merging `TabularReader` + `WideTableReader`)
- [x] Delete legacy `tabular_reader.py` and `wide_table_reader.py`
- [x] Update CSV, Excel, DataFrame readers to use new base

### 2. Flatten `formats/`
- [x] Move CSV reader → `io/formats/csv_reader.py`
- [x] Move Excel reader → `io/formats/excel_reader.py`
- [x] Move Excel writer → `io/formats/excel_writer.py`
- [x] Move DataFrame reader/writer → `io/formats/dataframe_reader.py` / `dataframe_writer.py`
- [x] Move Dict reader/writer → `io/formats/dict_reader.py` / `dict_writer.py`
- [x] Move FMP reader → `io/formats/fmp_reader.py`
- [x] Move Markdown writer → `io/formats/markdown_writer.py` and removed all legacy shims
- [x] Rewrite new `formats/__init__.py` with minimal import side-effects

### 3. Extract specialized helpers
- [x] Move adjustments helpers → `io/adjustments/excel_io.py`
- [x] Move graph definition helpers → `io/graph/definition_io.py`
- [x] Move cells importer → `io/graph/cells_io.py`
- [x] Move statement utils → `io/statements/utils.py`
- [x] Delete `io/specialized/` package after moves

### 4. Public surface cleanup
- [ ] Slim-down `io/__init__.py` to façade + registry + key helpers
- [ ] Remove export of private mixins/format classes

### 5. Import-path updates
- [ ] Update all intra-package imports to new locations
- [ ] Run linters / `ruff --fix` to auto-organise imports

### 6. Tests & CI
- [ ] Fix test import paths under `tests/io/`
- [ ] Run full `nox -s tests` until green

### 7. Final cleanup
- [ ] Remove empty directories
- [ ] Run `mypy --strict`
- [ ] Commit and push

---
(Keep this checklist up to date – tick a box when the corresponding change is completed.)